

##############################################
PALM: Prompt Learning in Audio Language Models
##############################################




Model:    COOP
Dataset:  ESC50
Seed:     0


Creating a 16-shot dataset ...


################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: 16

Total Number of Samples: 800

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################




################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: -1

Total Number of Samples: 400

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################


REDACTED/.venvs/palm/lib/python3.8/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Initializing a Generic Context for Coop ...
args:  Namespace(batch_size=16, classnames=['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind'], ctx_dim=512, dataset_root='REDACTED/Audio-Datasets/ESC50', device=device(type='cuda'), do_logging=True, eval_only=False, exp_name='ESC50-FOLD1', freq_test_model=10, json_file_path='logs/coop/ESC50-FOLD1.json', log_dir='logs/coop', lr=0.05, model_name='coop', model_path='', n_ctx=16, n_epochs=50, num_shots=16, process_audio_fn=<bound method PengiWrapper.preprocess_audio of <pengi.wrapper.PengiWrapper object at 0x7fd0952c0e50>>, prompt_prefix='The is a recording of ', repeat=False, resample=True, rho=0.3, save_model_path='REDACTED/Audio-Datasets/ESC50', seed=0, spec_aug=False, start_epoch=0)

  0%|          | 0/50 [00:00<?, ?it/s]
  2%|2         | 1/50 [00:11<09:14, 11.32s/it]
  4%|4         | 2/50 [00:22<09:00, 11.26s/it]
  6%|6         | 3/50 [00:34<08:55, 11.39s/it]
  8%|8         | 4/50 [00:45<08:49, 11.52s/it]
 10%|#         | 5/50 [00:57<08:40, 11.57s/it]
 12%|#2        | 6/50 [01:08<08:26, 11.50s/it]
 14%|#4        | 7/50 [01:20<08:13, 11.49s/it]
 16%|#6        | 8/50 [01:31<08:01, 11.45s/it]
 18%|#8        | 9/50 [01:43<07:49, 11.46s/it]

Epoch 10/50

Accuracy             = 0.8675
F1-Score             = 0.8682
Precision            = 0.8743
Recall               = 0.8675
Average Loss         = 0.4576



 20%|##        | 10/50 [01:54<07:37, 11.44s/it]
 22%|##2       | 11/50 [02:05<07:25, 11.41s/it]
 24%|##4       | 12/50 [02:17<07:14, 11.44s/it]
 26%|##6       | 13/50 [02:28<07:03, 11.44s/it]
 28%|##8       | 14/50 [02:40<06:52, 11.46s/it]
 30%|###       | 15/50 [02:51<06:40, 11.43s/it]
 32%|###2      | 16/50 [03:02<06:26, 11.36s/it]
 34%|###4      | 17/50 [03:14<06:17, 11.43s/it]
 36%|###6      | 18/50 [03:25<06:05, 11.42s/it]
 38%|###8      | 19/50 [03:37<05:53, 11.41s/it]

Epoch 20/50

Accuracy             = 0.9012
F1-Score             = 0.9015
Precision            = 0.9069
Recall               = 0.9012
Average Loss         = 0.3489



 40%|####      | 20/50 [03:48<05:44, 11.48s/it]
 42%|####2     | 21/50 [04:00<05:32, 11.46s/it]
 44%|####4     | 22/50 [04:11<05:19, 11.40s/it]
 46%|####6     | 23/50 [04:23<05:07, 11.40s/it]
 48%|####8     | 24/50 [04:34<04:57, 11.43s/it]
 50%|#####     | 25/50 [04:46<04:47, 11.49s/it]
 52%|#####2    | 26/50 [04:57<04:37, 11.56s/it]
 54%|#####4    | 27/50 [05:09<04:26, 11.59s/it]
 56%|#####6    | 28/50 [05:20<04:14, 11.55s/it]
 58%|#####8    | 29/50 [05:32<04:01, 11.52s/it]

Epoch 30/50

Accuracy             = 0.9350
F1-Score             = 0.9349
Precision            = 0.9381
Recall               = 0.9350
Average Loss         = 0.2580



 60%|######    | 30/50 [05:43<03:48, 11.44s/it]
 62%|######2   | 31/50 [05:55<03:36, 11.42s/it]
 64%|######4   | 32/50 [06:06<03:26, 11.45s/it]
 66%|######6   | 33/50 [06:17<03:14, 11.42s/it]
 68%|######8   | 34/50 [06:29<03:02, 11.43s/it]
 70%|#######   | 35/50 [06:40<02:51, 11.41s/it]
 72%|#######2  | 36/50 [06:52<02:39, 11.41s/it]
 74%|#######4  | 37/50 [07:03<02:28, 11.42s/it]
 76%|#######6  | 38/50 [07:15<02:17, 11.43s/it]
 78%|#######8  | 39/50 [07:26<02:06, 11.47s/it]

Epoch 40/50

Accuracy             = 0.9475
F1-Score             = 0.9476
Precision            = 0.9508
Recall               = 0.9475
Average Loss         = 0.2037



 80%|########  | 40/50 [07:38<01:54, 11.46s/it]
 82%|########2 | 41/50 [07:49<01:42, 11.43s/it]
 84%|########4 | 42/50 [08:00<01:31, 11.42s/it]
 86%|########6 | 43/50 [08:12<01:20, 11.43s/it]
 88%|########8 | 44/50 [08:23<01:08, 11.41s/it]
 90%|######### | 45/50 [08:35<00:57, 11.42s/it]
 92%|#########2| 46/50 [08:46<00:45, 11.40s/it]
 94%|#########3| 47/50 [08:57<00:34, 11.39s/it]
 96%|#########6| 48/50 [09:09<00:22, 11.43s/it]
 98%|#########8| 49/50 [09:21<00:11, 11.52s/it]

Epoch 50/50

Accuracy             = 0.9525
F1-Score             = 0.9526
Precision            = 0.9540
Recall               = 0.9525
Average Loss         = 0.1794




Evaluating the model ...


  0%|          | 0/4 [00:00<?, ?it/s][A

 25%|##5       | 1/4 [00:01<00:03,  1.17s/it][A

 50%|#####     | 2/4 [00:01<00:01,  1.69it/s][A

 75%|#######5  | 3/4 [00:01<00:00,  2.26it/s][A

100%|##########| 4/4 [00:01<00:00,  3.03it/s][A
100%|##########| 4/4 [00:01<00:00,  2.02it/s]


Time & Date = 10:24 PM , 09_Jun_2024

Total Time => 0 Hours : 0 Minutes : 2 Seconds



Epoch 50/50

Accuracy             = 0.9225
F1-Score             = 0.9209
Precision            = 0.9400
Recall               = 0.9225
Average Loss         = 0.2018




Final Evaluation
Saving Results ...
Results Saved



100%|##########| 50/50 [09:35<00:00, 12.34s/it]
100%|##########| 50/50 [09:35<00:00, 11.51s/it]


Time & Date = 10:24 PM , 09_Jun_2024

Total Time => 0 Hours : 9 Minutes : 35 Seconds


