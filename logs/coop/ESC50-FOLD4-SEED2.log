

##############################################
PALM: Prompt Learning in Audio Language Models
##############################################




Model:    COOP
Dataset:  ESC50
Seed:     2


Creating a 16-shot dataset ...


################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: 16

Total Number of Samples: 800

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################




################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: -1

Total Number of Samples: 400

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################


REDACTED/.venvs/palm/lib/python3.8/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Initializing a Generic Context for Coop ...
args:  Namespace(batch_size=16, classnames=['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind'], ctx_dim=512, dataset_root='REDACTED/Audio-Datasets/ESC50', device=device(type='cuda'), do_logging=True, eval_only=False, exp_name='ESC50-FOLD4', freq_test_model=10, json_file_path='logs/coop/ESC50-FOLD4.json', log_dir='logs/coop', lr=0.05, model_name='coop', model_path='', n_ctx=16, n_epochs=50, num_shots=16, process_audio_fn=<bound method PengiWrapper.preprocess_audio of <pengi.wrapper.PengiWrapper object at 0x7f21d4175e50>>, prompt_prefix='The is a recording of ', repeat=False, resample=True, rho=0.3, save_model_path='REDACTED/Audio-Datasets/ESC50', seed=2, spec_aug=False, start_epoch=0)

  0%|          | 0/50 [00:00<?, ?it/s]
  2%|2         | 1/50 [00:11<09:43, 11.90s/it]
  4%|4         | 2/50 [00:23<09:28, 11.84s/it]
  6%|6         | 3/50 [00:35<09:14, 11.80s/it]
  8%|8         | 4/50 [00:47<09:01, 11.78s/it]
 10%|#         | 5/50 [00:58<08:47, 11.72s/it]
 12%|#2        | 6/50 [01:10<08:39, 11.80s/it]
 14%|#4        | 7/50 [01:22<08:26, 11.78s/it]
 16%|#6        | 8/50 [01:34<08:14, 11.78s/it]
 18%|#8        | 9/50 [01:46<08:03, 11.78s/it]

Epoch 10/50

Accuracy             = 0.8975
F1-Score             = 0.8959
Precision            = 0.8992
Recall               = 0.8975
Average Loss         = 0.3498



 20%|##        | 10/50 [01:57<07:50, 11.77s/it]
 22%|##2       | 11/50 [02:09<07:38, 11.75s/it]
 24%|##4       | 12/50 [02:21<07:26, 11.75s/it]
 26%|##6       | 13/50 [02:33<07:17, 11.84s/it]
 28%|##8       | 14/50 [02:45<07:08, 11.90s/it]
 30%|###       | 15/50 [02:57<06:54, 11.84s/it]
 32%|###2      | 16/50 [03:08<06:40, 11.79s/it]
 34%|###4      | 17/50 [03:20<06:28, 11.76s/it]
 36%|###6      | 18/50 [03:32<06:16, 11.76s/it]
 38%|###8      | 19/50 [03:43<06:04, 11.76s/it]

Epoch 20/50

Accuracy             = 0.9375
F1-Score             = 0.9375
Precision            = 0.9396
Recall               = 0.9375
Average Loss         = 0.2312



 40%|####      | 20/50 [03:55<05:53, 11.78s/it]
 42%|####2     | 21/50 [04:07<05:41, 11.78s/it]
 44%|####4     | 22/50 [04:19<05:29, 11.76s/it]
 46%|####6     | 23/50 [04:31<05:17, 11.76s/it]
 48%|####8     | 24/50 [04:42<05:05, 11.75s/it]
 50%|#####     | 25/50 [04:54<04:54, 11.76s/it]
 52%|#####2    | 26/50 [05:06<04:44, 11.85s/it]
 54%|#####4    | 27/50 [05:18<04:31, 11.82s/it]
 56%|#####6    | 28/50 [05:29<04:19, 11.78s/it]
 58%|#####8    | 29/50 [05:41<04:06, 11.74s/it]

Epoch 30/50

Accuracy             = 0.9487
F1-Score             = 0.9490
Precision            = 0.9513
Recall               = 0.9487
Average Loss         = 0.1744



 60%|######    | 30/50 [05:53<03:54, 11.73s/it]
 62%|######2   | 31/50 [06:05<03:44, 11.79s/it]
 64%|######4   | 32/50 [06:17<03:31, 11.77s/it]
 66%|######6   | 33/50 [06:28<03:20, 11.77s/it]
 68%|######8   | 34/50 [06:40<03:08, 11.76s/it]
 70%|#######   | 35/50 [06:52<02:58, 11.88s/it]
 72%|#######2  | 36/50 [07:04<02:47, 11.97s/it]
 74%|#######4  | 37/50 [07:16<02:34, 11.89s/it]
 76%|#######6  | 38/50 [07:28<02:22, 11.84s/it]
 78%|#######8  | 39/50 [07:40<02:09, 11.81s/it]

Epoch 40/50

Accuracy             = 0.9600
F1-Score             = 0.9602
Precision            = 0.9616
Recall               = 0.9600
Average Loss         = 0.1677



 80%|########  | 40/50 [07:51<01:58, 11.83s/it]
 82%|########2 | 41/50 [08:03<01:46, 11.81s/it]
 84%|########4 | 42/50 [08:15<01:34, 11.80s/it]
 86%|########6 | 43/50 [08:27<01:22, 11.79s/it]
 88%|########8 | 44/50 [08:39<01:10, 11.79s/it]
 90%|######### | 45/50 [08:50<00:58, 11.77s/it]
 92%|#########2| 46/50 [09:02<00:46, 11.73s/it]
 94%|#########3| 47/50 [09:14<00:35, 11.75s/it]
 96%|#########6| 48/50 [09:25<00:23, 11.72s/it]
 98%|#########8| 49/50 [09:37<00:11, 11.68s/it]

Epoch 50/50

Accuracy             = 0.9650
F1-Score             = 0.9648
Precision            = 0.9663
Recall               = 0.9650
Average Loss         = 0.1499




Evaluating the model ...


  0%|          | 0/4 [00:00<?, ?it/s][A

 25%|##5       | 1/4 [00:01<00:03,  1.18s/it][A

 50%|#####     | 2/4 [00:01<00:01,  1.68it/s][A

 75%|#######5  | 3/4 [00:01<00:00,  2.34it/s][A

100%|##########| 4/4 [00:01<00:00,  3.12it/s][A
100%|##########| 4/4 [00:02<00:00,  2.00it/s]


Time & Date = 12:19 AM , 10_Jun_2024

Total Time => 0 Hours : 0 Minutes : 2 Seconds



Epoch 50/50

Accuracy             = 0.9450
F1-Score             = 0.9450
Precision            = 0.9512
Recall               = 0.9450
Average Loss         = 0.2230




Final Evaluation
Saving Results ...
Results Saved



100%|##########| 50/50 [09:52<00:00, 12.57s/it]
100%|##########| 50/50 [09:52<00:00, 11.84s/it]


Time & Date = 12:19 AM , 10_Jun_2024

Total Time => 0 Hours : 9 Minutes : 52 Seconds


