

##############################################
PALM: Prompt Learning in Audio Language Models
##############################################




Model:    COOP
Dataset:  ESC50
Seed:     1


Creating a 16-shot dataset ...


################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: 16

Total Number of Samples: 800

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################




################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: -1

Total Number of Samples: 400

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################


REDACTED/.venvs/palm/lib/python3.8/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Initializing a Generic Context for Coop ...
args:  Namespace(batch_size=16, classnames=['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind'], ctx_dim=512, dataset_root='REDACTED/Audio-Datasets/ESC50', device=device(type='cuda'), do_logging=True, eval_only=False, exp_name='ESC50-FOLD5', freq_test_model=10, json_file_path='logs/coop/ESC50-FOLD5.json', log_dir='logs/coop', lr=0.05, model_name='coop', model_path='', n_ctx=16, n_epochs=50, num_shots=16, process_audio_fn=<bound method PengiWrapper.preprocess_audio of <pengi.wrapper.PengiWrapper object at 0x7f9ab16bfe50>>, prompt_prefix='The is a recording of ', repeat=False, resample=True, rho=0.3, save_model_path='REDACTED/Audio-Datasets/ESC50', seed=1, spec_aug=False, start_epoch=0)

  0%|          | 0/50 [00:00<?, ?it/s]
  2%|2         | 1/50 [00:11<09:30, 11.64s/it]
  4%|4         | 2/50 [00:23<09:14, 11.56s/it]
  6%|6         | 3/50 [00:34<09:03, 11.56s/it]
  8%|8         | 4/50 [00:46<08:53, 11.60s/it]
 10%|#         | 5/50 [00:58<08:43, 11.63s/it]
 12%|#2        | 6/50 [01:09<08:31, 11.63s/it]
 14%|#4        | 7/50 [01:21<08:17, 11.58s/it]
 16%|#6        | 8/50 [01:32<08:03, 11.51s/it]
 18%|#8        | 9/50 [01:43<07:49, 11.46s/it]

Epoch 10/50

Accuracy             = 0.8712
F1-Score             = 0.8701
Precision            = 0.8762
Recall               = 0.8712
Average Loss         = 0.4150



 20%|##        | 10/50 [01:55<07:39, 11.48s/it]
 22%|##2       | 11/50 [02:07<07:29, 11.53s/it]
 24%|##4       | 12/50 [02:18<07:18, 11.53s/it]
 26%|##6       | 13/50 [02:30<07:06, 11.54s/it]
 28%|##8       | 14/50 [02:41<06:56, 11.57s/it]
 30%|###       | 15/50 [02:53<06:44, 11.55s/it]
 32%|###2      | 16/50 [03:05<06:35, 11.63s/it]
 34%|###4      | 17/50 [03:17<06:29, 11.79s/it]
 36%|###6      | 18/50 [03:28<06:16, 11.76s/it]
 38%|###8      | 19/50 [03:40<06:03, 11.73s/it]

Epoch 20/50

Accuracy             = 0.9237
F1-Score             = 0.9232
Precision            = 0.9263
Recall               = 0.9237
Average Loss         = 0.2740



 40%|####      | 20/50 [03:52<05:50, 11.68s/it]
 42%|####2     | 21/50 [04:03<05:38, 11.69s/it]
 44%|####4     | 22/50 [04:15<05:26, 11.64s/it]
 46%|####6     | 23/50 [04:27<05:14, 11.65s/it]
 48%|####8     | 24/50 [04:38<05:02, 11.64s/it]
 50%|#####     | 25/50 [04:50<04:51, 11.65s/it]
 52%|#####2    | 26/50 [05:02<04:39, 11.64s/it]
 54%|#####4    | 27/50 [05:13<04:27, 11.63s/it]
 56%|#####6    | 28/50 [05:25<04:16, 11.64s/it]
 58%|#####8    | 29/50 [05:36<04:04, 11.66s/it]

Epoch 30/50

Accuracy             = 0.9425
F1-Score             = 0.9422
Precision            = 0.9440
Recall               = 0.9425
Average Loss         = 0.2130



 60%|######    | 30/50 [05:48<03:54, 11.73s/it]
 62%|######2   | 31/50 [06:00<03:43, 11.74s/it]
 64%|######4   | 32/50 [06:12<03:30, 11.71s/it]
 66%|######6   | 33/50 [06:23<03:18, 11.68s/it]
 68%|######8   | 34/50 [06:35<03:07, 11.73s/it]
 70%|#######   | 35/50 [06:47<02:55, 11.71s/it]
 72%|#######2  | 36/50 [06:59<02:43, 11.70s/it]
 74%|#######4  | 37/50 [07:10<02:32, 11.69s/it]
 76%|#######6  | 38/50 [07:22<02:20, 11.72s/it]
 78%|#######8  | 39/50 [07:34<02:09, 11.77s/it]

Epoch 40/50

Accuracy             = 0.9225
F1-Score             = 0.9228
Precision            = 0.9247
Recall               = 0.9225
Average Loss         = 0.2253



 80%|########  | 40/50 [07:46<01:57, 11.77s/it]
 82%|########2 | 41/50 [07:57<01:46, 11.78s/it]
 84%|########4 | 42/50 [08:09<01:33, 11.75s/it]
 86%|########6 | 43/50 [08:21<01:22, 11.72s/it]
 88%|########8 | 44/50 [08:32<01:09, 11.64s/it]
 90%|######### | 45/50 [08:44<00:57, 11.57s/it]
 92%|#########2| 46/50 [08:55<00:46, 11.56s/it]
 94%|#########3| 47/50 [09:07<00:34, 11.58s/it]
 96%|#########6| 48/50 [09:19<00:23, 11.61s/it]
 98%|#########8| 49/50 [09:30<00:11, 11.63s/it]

Epoch 50/50

Accuracy             = 0.9537
F1-Score             = 0.9538
Precision            = 0.9556
Recall               = 0.9537
Average Loss         = 0.2091




Evaluating the model ...


  0%|          | 0/4 [00:00<?, ?it/s][A

 25%|##5       | 1/4 [00:01<00:03,  1.22s/it][A

 50%|#####     | 2/4 [00:01<00:01,  1.62it/s][A

 75%|#######5  | 3/4 [00:01<00:00,  2.21it/s][A

100%|##########| 4/4 [00:01<00:00,  2.89it/s][A
100%|##########| 4/4 [00:02<00:00,  1.92it/s]


Time & Date = 12:40 AM , 10_Jun_2024

Total Time => 0 Hours : 0 Minutes : 2 Seconds



Epoch 50/50

Accuracy             = 0.9300
F1-Score             = 0.9293
Precision            = 0.9389
Recall               = 0.9300
Average Loss         = 0.3484




Final Evaluation
Saving Results ...
Results Saved



100%|##########| 50/50 [09:45<00:00, 12.55s/it]
100%|##########| 50/50 [09:45<00:00, 11.71s/it]


Time & Date = 12:40 AM , 10_Jun_2024

Total Time => 0 Hours : 9 Minutes : 45 Seconds


