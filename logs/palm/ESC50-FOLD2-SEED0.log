

##############################################
PALM: Prompt Learning in Audio Language Models
##############################################




Model:    PALM_TEXT
Dataset:  ESC50
Seed:     0


Creating a 16-shot dataset ...


################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: 16

Total Number of Samples: 800

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################




################## Dataset Information ##################
FewShot Dataset

Root: REDACTED/Audio-Datasets/ESC50

Number of Classes: 50

Number of Shots: -1

Total Number of Samples: 400

Classnames: ['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind']

Label to Classname: {0: 'airplane', 1: 'breathing', 2: 'brushing teeth', 3: 'can opening', 4: 'car horn', 5: 'cat', 6: 'chainsaw', 7: 'chirping birds', 8: 'church bells', 9: 'clapping', 10: 'clock alarm', 11: 'clock tick', 12: 'coughing', 13: 'cow', 14: 'crackling fire', 15: 'crickets', 16: 'crow', 17: 'crying baby', 18: 'dog', 19: 'door wood creaks', 20: 'door wood knock', 21: 'drinking sipping', 22: 'engine', 23: 'fireworks', 24: 'footsteps', 25: 'frog', 26: 'glass breaking', 27: 'hand saw', 28: 'helicopter', 29: 'hen', 30: 'insects', 31: 'keyboard typing', 32: 'laughing', 33: 'mouse click', 34: 'pig', 35: 'pouring water', 36: 'rain', 37: 'rooster', 38: 'sea waves', 39: 'sheep', 40: 'siren', 41: 'sneezing', 42: 'snoring', 43: 'thunderstorm', 44: 'toilet flush', 45: 'train', 46: 'vacuum cleaner', 47: 'washing machine', 48: 'water drops', 49: 'wind'}

Classname to Label: {'airplane': 0, 'breathing': 1, 'brushing teeth': 2, 'can opening': 3, 'car horn': 4, 'cat': 5, 'chainsaw': 6, 'chirping birds': 7, 'church bells': 8, 'clapping': 9, 'clock alarm': 10, 'clock tick': 11, 'coughing': 12, 'cow': 13, 'crackling fire': 14, 'crickets': 15, 'crow': 16, 'crying baby': 17, 'dog': 18, 'door wood creaks': 19, 'door wood knock': 20, 'drinking sipping': 21, 'engine': 22, 'fireworks': 23, 'footsteps': 24, 'frog': 25, 'glass breaking': 26, 'hand saw': 27, 'helicopter': 28, 'hen': 29, 'insects': 30, 'keyboard typing': 31, 'laughing': 32, 'mouse click': 33, 'pig': 34, 'pouring water': 35, 'rain': 36, 'rooster': 37, 'sea waves': 38, 'sheep': 39, 'siren': 40, 'sneezing': 41, 'snoring': 42, 'thunderstorm': 43, 'toilet flush': 44, 'train': 45, 'vacuum cleaner': 46, 'washing machine': 47, 'water drops': 48, 'wind': 49}
########################################################


REDACTED/.venvs/palm/lib/python3.8/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Initializing a generic context
args:  Namespace(batch_size=16, classnames=['airplane', 'breathing', 'brushing teeth', 'can opening', 'car horn', 'cat', 'chainsaw', 'chirping birds', 'church bells', 'clapping', 'clock alarm', 'clock tick', 'coughing', 'cow', 'crackling fire', 'crickets', 'crow', 'crying baby', 'dog', 'door wood creaks', 'door wood knock', 'drinking sipping', 'engine', 'fireworks', 'footsteps', 'frog', 'glass breaking', 'hand saw', 'helicopter', 'hen', 'insects', 'keyboard typing', 'laughing', 'mouse click', 'pig', 'pouring water', 'rain', 'rooster', 'sea waves', 'sheep', 'siren', 'sneezing', 'snoring', 'thunderstorm', 'toilet flush', 'train', 'vacuum cleaner', 'washing machine', 'water drops', 'wind'], ctx_dim=1024, dataset_root='REDACTED/Audio-Datasets/ESC50', device=device(type='cuda'), do_logging=True, eval_only=False, exp_name='ESC50-FOLD2', freq_test_model=10, json_file_path='logs/palm_text/ESC50-FOLD2.json', log_dir='logs/palm_text', lr=0.05, model_name='palm_text', model_path='', n_ctx=16, n_epochs=50, num_shots=16, process_audio_fn=<bound method PengiWrapper.preprocess_audio of <pengi.wrapper.PengiWrapper object at 0x7f2d84517e50>>, prompt_prefix='The is a recording of ', repeat=False, resample=True, rho=0.3, save_model_path='REDACTED/Audio-Datasets/ESC50', seed=0, spec_aug=False, start_epoch=0)

  0%|          | 0/50 [00:00<?, ?it/s]
  2%|2         | 1/50 [00:11<09:10, 11.23s/it]
  4%|4         | 2/50 [00:22<08:52, 11.09s/it]
  6%|6         | 3/50 [00:33<08:39, 11.05s/it]
  8%|8         | 4/50 [00:44<08:25, 11.00s/it]
 10%|#         | 5/50 [00:55<08:13, 10.97s/it]
 12%|#2        | 6/50 [01:06<08:04, 11.00s/it]
 14%|#4        | 7/50 [01:17<07:53, 11.00s/it]
 16%|#6        | 8/50 [01:28<07:40, 10.97s/it]
 18%|#8        | 9/50 [01:38<07:29, 10.96s/it]

Epoch 10/50

Accuracy             = 0.9862
F1-Score             = 0.9862
Precision            = 0.9867
Recall               = 0.9862
Average Loss         = 0.0415



 20%|##        | 10/50 [01:49<07:17, 10.95s/it]
 22%|##2       | 11/50 [02:00<07:06, 10.94s/it]
 24%|##4       | 12/50 [02:11<06:56, 10.96s/it]
 26%|##6       | 13/50 [02:22<06:45, 10.95s/it]
 28%|##8       | 14/50 [02:33<06:33, 10.94s/it]
 30%|###       | 15/50 [02:44<06:21, 10.91s/it]
 32%|###2      | 16/50 [02:55<06:11, 10.92s/it]
 34%|###4      | 17/50 [03:06<06:00, 10.91s/it]
 36%|###6      | 18/50 [03:17<05:47, 10.87s/it]
 38%|###8      | 19/50 [03:27<05:35, 10.84s/it]

Epoch 20/50

Accuracy             = 0.9962
F1-Score             = 0.9963
Precision            = 0.9966
Recall               = 0.9962
Average Loss         = 0.0052



 40%|####      | 20/50 [03:38<05:26, 10.88s/it]
 42%|####2     | 21/50 [03:49<05:16, 10.90s/it]
 44%|####4     | 22/50 [04:00<05:05, 10.92s/it]
 46%|####6     | 23/50 [04:11<04:54, 10.91s/it]
 48%|####8     | 24/50 [04:22<04:44, 10.93s/it]
 50%|#####     | 25/50 [04:33<04:33, 10.95s/it]
 52%|#####2    | 26/50 [04:44<04:22, 10.93s/it]
 54%|#####4    | 27/50 [04:55<04:11, 10.95s/it]
 56%|#####6    | 28/50 [05:06<04:00, 10.95s/it]
 58%|#####8    | 29/50 [05:17<03:49, 10.91s/it]

Epoch 30/50

Accuracy             = 0.9912
F1-Score             = 0.9913
Precision            = 0.9919
Recall               = 0.9912
Average Loss         = 0.0309



 60%|######    | 30/50 [05:28<03:37, 10.88s/it]
 62%|######2   | 31/50 [05:38<03:26, 10.89s/it]
 64%|######4   | 32/50 [05:50<03:20, 11.13s/it]
 66%|######6   | 33/50 [06:07<03:39, 12.89s/it]
 68%|######8   | 34/50 [06:25<03:48, 14.31s/it]
 70%|#######   | 35/50 [06:38<03:29, 13.99s/it]
 72%|#######2  | 36/50 [06:50<03:07, 13.39s/it]
 74%|#######4  | 37/50 [07:01<02:45, 12.72s/it]
 76%|#######6  | 38/50 [07:12<02:26, 12.23s/it]
 78%|#######8  | 39/50 [07:23<02:10, 11.89s/it]

Epoch 40/50

Accuracy             = 0.9938
F1-Score             = 0.9937
Precision            = 0.9940
Recall               = 0.9938
Average Loss         = 0.0256



 80%|########  | 40/50 [07:35<01:56, 11.68s/it]
 82%|########2 | 41/50 [07:46<01:43, 11.54s/it]
 84%|########4 | 42/50 [07:57<01:31, 11.43s/it]
 86%|########6 | 43/50 [08:08<01:19, 11.33s/it]
 88%|########8 | 44/50 [08:19<01:07, 11.28s/it]
 90%|######### | 45/50 [08:30<00:56, 11.25s/it]
 92%|#########2| 46/50 [08:42<00:44, 11.22s/it]
 94%|#########3| 47/50 [08:53<00:33, 11.20s/it]
 96%|#########6| 48/50 [09:04<00:22, 11.19s/it]
 98%|#########8| 49/50 [09:15<00:11, 11.19s/it]

Epoch 50/50

Accuracy             = 0.9988
F1-Score             = 0.9987
Precision            = 0.9988
Recall               = 0.9988
Average Loss         = 0.0038




Evaluating the model ...


  0%|          | 0/4 [00:00<?, ?it/s][A

 25%|##5       | 1/4 [00:02<00:06,  2.03s/it][A

 50%|#####     | 2/4 [00:02<00:01,  1.05it/s][A

 75%|#######5  | 3/4 [00:02<00:00,  1.60it/s][A

100%|##########| 4/4 [00:02<00:00,  2.27it/s][A
100%|##########| 4/4 [00:02<00:00,  1.39it/s]


Time & Date = 01:30 AM , 10_Jun_2024

Total Time => 0 Hours : 0 Minutes : 3 Seconds



Epoch 50/50

Accuracy             = 0.9650
F1-Score             = 0.9648
Precision            = 0.9692
Recall               = 0.9650
Average Loss         = 0.2024




Final Evaluation
Saving Results ...
Results Saved



100%|##########| 50/50 [09:30<00:00, 12.30s/it]
100%|##########| 50/50 [09:30<00:00, 11.41s/it]


Time & Date = 01:30 AM , 10_Jun_2024

Total Time => 0 Hours : 9 Minutes : 30 Seconds


